<!DOCTYPE html>
<html lang="bn">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>মির্জা সাহেব কে বাঁচাও</title>

<style>
body{
  margin:0;
  overflow:hidden;
  font-family:Arial,sans-serif;
  background:linear-gradient(180deg,#0f2027,#203a43,#2c5364);
  color:white;
  touch-action:none;
  user-select:none;
}

#ui{
  position:fixed;
  top:10px;
  width:100%;
  z-index:10;
}

#title{
  text-align:center;
  font-weight:bold;
}

#score{
  position:fixed;
  top:10px;
  right:12px;
  font-size:16px;
}

#life{
  text-align:center;
  color:#ff7675;
}

canvas{display:block}

#startBtn{
  position:fixed;
  bottom:140px;
  left:50%;
  transform:translateX(-50%);
  padding:14px 30px;
  font-size:18px;
  border:none;
  border-radius:10px;
  background:#ff4757;
  color:white;
  z-index:10;
}

#controls{
  position:fixed;
  bottom:20px;
  left:0;
  width:100%;
  padding:0 35px 0 20px;
  display:flex;
  justify-content:space-between;
  z-index:10;
}

.ctrlBtn{
  width:70px;
  height:70px;
  border-radius:50%;
  background:rgba(255,255,255,0.2);
  border:none;
  position:relative;
}

.ctrlBtn:active{
  background:rgba(255,255,255,0.4);
}

.ctrlBtn::before{
  content:"";
  position:absolute;
  top:50%;
  left:50%;
  transform:translate(-50%,-50%);
  border-style:solid;
}

#leftBtn::before{
  border-width:14px 18px 14px 0;
  border-color:transparent white transparent transparent;
}

#rightBtn::before{
  border-width:14px 0 14px 18px;
  border-color:transparent transparent transparent white;
}

#footer{
  position:fixed;
  bottom:6px;
  width:100%;
  text-align:center;
  font-size:13px;
}

#footer span{color:#00ffd5;font-weight:bold;}

#loading{
  position:fixed;
  inset:0;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:26px;
  background:#0f2027;
  z-index:20;
}
</style>
</head>

<body>

<div id="loading">LOADING…</div>

<div id="ui">
  <div id="title">মির্জা সাহেব কে বাঁচাও</div>
  <div id="score">Score: 0</div>
  <div id="life">❤️❤️❤️</div>
</div>

<canvas id="game"></canvas>

<button id="startBtn">START</button>

<div id="controls">
  <div class="ctrlBtn" id="leftBtn"></div>
  <div class="ctrlBtn" id="rightBtn"></div>
</div>

<div id="footer">
  Developed by <span>Mahmud Gaming</span>
</div>

<script>
/* CANVAS */
const canvas=document.getElementById("game");
const ctx=canvas.getContext("2d");
canvas.width=innerWidth;
canvas.height=innerHeight;

/* IMAGES */
let loaded=0;
const heroImg=new Image();
const heroHitImg=new Image();
const villainImg=new Image();

heroImg.src="mirza.png";
heroHitImg.src="hit.png";
villainImg.src="nasir.png";

[heroImg,heroHitImg,villainImg].forEach(img=>{
  img.onload=()=>{loaded++;if(loaded===3)loading.style.display="none";}
});

/* AUDIO */
const bgMusic=new Audio("game.mp3");
bgMusic.loop=true;
bgMusic.volume=0.7;

const hitSound=new Audio("hit.mp3");
hitSound.volume=1;

/* STATE */
let state="idle";
let score=0,frame=0,difficulty=1,lives=3;

/* HERO */
let hero={
  x:canvas.width/2-40,
  y:canvas.height-140,
  w:80,h:110,
  speed:6,
  shake:0
};

/* VILLAIN */
let villain={
  x:canvas.width/2-55,
  y:20,
  w:110,h:140,
  dir:1,
  speed:3
};

let bullets=[];

/* START */
startBtn.onclick=()=>{
  state="play";
  score=0;frame=0;difficulty=1;lives=3;
  bullets=[];
  hero.x=canvas.width/2-hero.w/2;
  life.innerText="❤️❤️❤️";
  scoreDiv.innerText="Score: 0";
  bgMusic.currentTime=0;
  bgMusic.play().catch(()=>{});
  startBtn.style.display="none";
};

/* CONTROLS */
let moveLeft=false,moveRight=false;

function bind(btn,dir){
  btn.addEventListener("touchstart",e=>{e.preventDefault();dir(true);});
  btn.addEventListener("touchend",e=>{e.preventDefault();dir(false);});
  btn.addEventListener("mousedown",()=>dir(true));
  btn.addEventListener("mouseup",()=>dir(false));
}

bind(leftBtn,v=>moveLeft=v);
bind(rightBtn,v=>moveRight=v);

/* SHOOT */
function shoot(){
  bullets.push({
    x:villain.x+villain.w/2,
    y:villain.y+villain.h,
    vy:6+difficulty*1.2
  });
}

/* HIT */
function hit(){
  lives--;
  hero.shake=10;
  hitSound.currentTime=0;
  hitSound.play();
  life.innerText="❤️".repeat(lives);
  if(lives<=0){
    state="finish";
    bgMusic.pause();
    startBtn.style.display="block";
  }
}

/* LOOP */
function loop(){
  ctx.clearRect(0,0,canvas.width,canvas.height);

  if(state==="play"){
    if(moveLeft)hero.x-=hero.speed;
    if(moveRight)hero.x+=hero.speed;

    villain.x+=villain.dir*villain.speed;
    if(villain.x<=0||villain.x+villain.w>=canvas.width)villain.dir*=-1;

    if(frame%Math.max(40,120-difficulty*10)===0)shoot();

    bullets.forEach(b=>{
      b.y+=b.vy;
      ctx.fillStyle="gold";
      ctx.beginPath();
      ctx.arc(b.x,b.y,6,0,Math.PI*2);
      ctx.fill();

      if(hero.x<b.x&&hero.x+hero.w>b.x&&hero.y<b.y&&hero.y+hero.h>b.y){
        hit();
        b.y=canvas.height+100;
      }
    });

    bullets=bullets.filter(b=>b.y<canvas.height+50);

    score++;
    if(frame%300===0)difficulty+=0.3;
    scoreDiv.innerText="Score: "+score;
  }

  ctx.drawImage(villainImg,villain.x,villain.y,villain.w,villain.h);

  hero.x=Math.max(0,Math.min(canvas.width-hero.w,hero.x));
  let shake=hero.shake?Math.random()*6-3:0;
  if(hero.shake>0)hero.shake--;

  if(state==="finish"){
    ctx.drawImage(heroHitImg,hero.x-20,hero.y-20,hero.w+40,hero.h+40);
  }else{
    ctx.drawImage(heroImg,hero.x+shake,hero.y,hero.w,hero.h);
  }

  if(state==="finish"){
    ctx.font="bold 56px Arial";
    ctx.textAlign="center";
    ctx.fillText("FINISH",canvas.width/2,canvas.height/2);
  }

  frame++;
  requestAnimationFrame(loop);
}
loop();
</script>

</body>
</html>
