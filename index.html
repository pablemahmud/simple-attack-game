<!DOCTYPE html>
<html lang="bn">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>মির্জা সাহেব কে বাঁচাও</title>

<style>
body{
  margin:0;
  overflow:hidden;
  font-family:Arial,sans-serif;
  background:linear-gradient(180deg,#0f2027,#203a43,#2c5364);
  color:white;
}
#ui{
  position:fixed;
  top:10px;
  width:100%;
  text-align:center;
  z-index:10;
}
#score{margin-top:6px}
canvas{display:block}

#startBtn{
  position:fixed;
  bottom:80px;
  left:50%;
  transform:translateX(-50%);
  padding:14px 30px;
  font-size:18px;
  border:none;
  border-radius:10px;
  background:#ff4757;
  color:white;
}

#footer{
  position:fixed;
  bottom:8px;
  width:100%;
  text-align:center;
  font-size:13px;
}
#footer span{color:#00ffd5;font-weight:bold;}
</style>
</head>

<body>

<div id="ui">
  <b>মির্জা সাহেব কে বাঁচাও</b>
  <div id="score">Score: 0</div>
</div>

<canvas id="game"></canvas>

<button id="startBtn" onclick="startGame()">START</button>

<div id="footer">
  Developed by <span>Mahmud Gaming</span>
</div>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");
canvas.width = innerWidth;
canvas.height = innerHeight;

const ground = canvas.height - 150;

const heroImg = new Image();
heroImg.src = "mirza.png";

const villainImg = new Image();
villainImg.src = "nasir.png";

const ballImg = new Image();
ballImg.src = "ball.png";

let state = "idle"; // idle, countdown, play, finish
let countdown = 3;

let score = 0;
let frame = 0;
let speed = 2;

let hero = {
  x: 80,
  y: ground,
  w: 60,
  h: 80,
  vy: 0,
  jumping: false,
  runTick: 0
};

let villain = {
  x: canvas.width - 140,
  y: ground - 110,
  w: 90,
  h: 110
};

let balls = [];
const gravity = 1;

/* -------- START GAME -------- */
function startGame(){
  state = "countdown";
  countdown = 3;
  score = 0;
  frame = 0;
  speed = 2;
  balls = [];
  hero.y = ground;
  hero.vy = 0;
  document.getElementById("startBtn").style.display="none";
  document.getElementById("score").innerText="Score: 0";
}

/* -------- INPUT -------- */
document.addEventListener("click", ()=>{
  if(state!=="play") return;
  if(!hero.jumping){
    hero.vy = -18;
    hero.jumping = true;
    navigator.vibrate?.(30);
  }
});

/* -------- THROW BALL -------- */
function throwBall(){
  balls.push({
    x: villain.x,
    y: villain.y + 30,
    vx: -speed - 2,
    vy: -8
  });
}

/* -------- GAME LOOP -------- */
function loop(){
  ctx.clearRect(0,0,canvas.width,canvas.height);

  // villain (fixed)
  ctx.drawImage(villainImg,villain.x,villain.y,villain.w,villain.h);

  if(state==="countdown"){
    ctx.font="bold 60px Arial";
    ctx.textAlign="center";
    ctx.fillText(countdown,canvas.width/2,canvas.height/2);
    if(frame%60===0){
      countdown--;
      if(countdown===0){
        state="play";
      }
    }
  }

  if(state==="play"){
    // difficulty
    if(frame%300===0) speed+=0.4;

    // hero physics
    hero.vy+=gravity;
    hero.y+=hero.vy;
    if(hero.y>=ground){
      hero.y=ground;
      hero.vy=0;
      hero.jumping=false;
    }

    hero.runTick++;

    // throw ball
    if(frame%120===0) throwBall();

    balls.forEach(b=>{
      b.x+=b.vx;
      b.y+=b.vy;
      b.vy+=0.5;

      // collision
      if(
        hero.x < b.x+20 &&
        hero.x+hero.w > b.x &&
        hero.y < b.y+20 &&
        hero.y+hero.h > b.y
      ){
        navigator.vibrate?.([100,50,100]);
        state="finish";
      }

      if(ballImg.complete){
        ctx.drawImage(ballImg,b.x,b.y,24,24);
      }else{
        ctx.fillStyle="red";
        ctx.beginPath();
        ctx.arc(b.x,b.y,10,0,Math.PI*2);
        ctx.fill();
      }
    });

    balls = balls.filter(b=>b.x>-50);
    score++;
    document.getElementById("score").innerText="Score: "+score;
  }

  // hero draw (run / jump visual)
  let runScale = hero.jumping ? 1 : 1 + Math.sin(hero.runTick*0.3)*0.05;
  ctx.drawImage(
    heroImg,
    hero.x,
    hero.y,
    hero.w*runScale,
    hero.h
  );

  // FINISH
  if(state==="finish"){
    ctx.font="bold 56px Arial";
    ctx.textAlign="center";
    ctx.fillText("FINISH",canvas.width/2,canvas.height/2);
    document.getElementById("startBtn").style.display="block";
  }

  frame++;
  requestAnimationFrame(loop);
}

loop();
</script>

</body>
</html>
