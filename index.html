<!DOCTYPE html>
<html lang="bn">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>মির্জা সাহেব কে বাঁচাও</title>

<style>
body{
  margin:0;
  overflow:hidden;
  font-family:Arial,sans-serif;
  background:linear-gradient(180deg,#0f2027,#203a43,#2c5364);
  color:white;
  touch-action: none; /* important for swipe */
}
#ui{
  position:fixed;
  top:10px;
  width:100%;
  text-align:center;
  z-index:10;
}
#score{margin-top:4px}
#life{margin-top:4px;color:#ff7675}
#startBtn{
  position:fixed;
  bottom:80px;
  left:50%;
  transform:translateX(-50%);
  padding:14px 30px;
  font-size:18px;
  border:none;
  border-radius:10px;
  background:#ff4757;
  color:white;
  z-index:10;
}
#footer{
  position:fixed;
  bottom:8px;
  width:100%;
  text-align:center;
  font-size:13px;
}
#footer span{color:#00ffd5;font-weight:bold;}
canvas{display:block}
</style>
</head>

<body>

<div id="ui">
  <b>মির্জা সাহেব কে বাঁচাও</b>
  <div id="score">Score: 0</div>
  <div id="life">❤️❤️❤️</div>
</div>

<canvas id="game"></canvas>

<button id="startBtn" onclick="startGame()">START</button>

<div id="footer">
  Developed by <span>Mahmud Gaming</span>
</div>

<script>
/* ================== SETUP ================== */
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");
canvas.width = innerWidth;
canvas.height = innerHeight;

const heroImg = new Image();
heroImg.src = "mirza.png";
const villainImg = new Image();
villainImg.src = "nasir.png";

/* ================== GAME STATE ================== */
let state = "idle"; // idle, play, finish
let score = 0, frame = 0, difficulty = 1;
let lives = 3;

/* ================== HERO ================== */
let hero = {
  x: canvas.width/2 - 30,
  y: canvas.height - 110,
  w: 60,
  h: 80,
  speed: 7,
  shake: 0
};

/* ================== VILLAIN ================== */
let villain = {
  x: canvas.width/2 - 40,
  y: 20,
  w: 80,
  h: 100,
  dir: 1,
  speed: 3
};

let bullets = [];

/* ================== START ================== */
function startGame(){
  state = "play";
  score = 0;
  frame = 0;
  difficulty = 1;
  lives = 3;
  bullets = [];
  hero.x = canvas.width/2 - hero.w/2;
  document.getElementById("life").innerText = "❤️❤️❤️";
  document.getElementById("score").innerText = "Score: 0";
  document.getElementById("startBtn").style.display = "none";
}

/* ================== INPUT (KEYBOARD) ================== */
document.addEventListener("keydown", e => {
  if(state !== "play") return;
  if(e.code === "ArrowLeft") hero.x -= hero.speed;
  if(e.code === "ArrowRight") hero.x += hero.speed;
});

/* ================== INPUT (SWIPE) ================== */
let touchStartX = 0;

document.addEventListener("touchstart", e => {
  touchStartX = e.touches[0].clientX;
});

document.addEventListener("touchend", e => {
  if(state !== "play") return;
  let touchEndX = e.changedTouches[0].clientX;
  let diff = touchEndX - touchStartX;

  if(Math.abs(diff) > 30){
    if(diff > 0){
      hero.x += hero.speed * 6; // swipe right
    } else {
      hero.x -= hero.speed * 6; // swipe left
    }
  }
});

/* ================== SHOOT ================== */
function shoot(){
  bullets.push({
    x: villain.x + villain.w/2,
    y: villain.y + villain.h,
    vy: 6 + difficulty
  });
}

/* ================== HIT ================== */
function hit(){
  lives--;
  hero.shake = 10;
  navigator.vibrate?.([80,40,80]);
  document.getElementById("life").innerText = "❤️".repeat(lives);

  if(lives <= 0){
    state = "finish";
    document.getElementById("startBtn").style.display = "block";
  }
}

/* ================== LOOP ================== */
function loop(){
  ctx.clearRect(0,0,canvas.width,canvas.height);

  if(state === "play"){
    // Villain movement
    villain.x += villain.dir * villain.speed * difficulty;
    if(villain.x <= 0 || villain.x + villain.w >= canvas.width){
      villain.dir *= -1;
    }

    // Shooting
    if(frame % Math.max(40, 120 - difficulty * 10) === 0){
      shoot();
    }

    bullets.forEach(b => {
      b.y += b.vy;
      ctx.fillStyle = "gold";
      ctx.beginPath();
      ctx.arc(b.x, b.y, 6, 0, Math.PI*2);
      ctx.fill();

      // Collision
      if(
        hero.x < b.x + 6 &&
        hero.x + hero.w > b.x - 6 &&
        hero.y < b.y + 6 &&
        hero.y + hero.h > b.y
      ){
        hit();
        b.y = canvas.height + 100;
      }
    });

    bullets = bullets.filter(b => b.y < canvas.height + 50);

    score++;
    if(frame % 300 === 0) difficulty += 0.3;
    document.getElementById("score").innerText = "Score: " + score;
  }

  // Draw villain
  ctx.drawImage(villainImg, villain.x, villain.y, villain.w, villain.h);

  // Hero bounds
  hero.x = Math.max(0, Math.min(canvas.width - hero.w, hero.x));

  // Hero shake
  let shakeX = hero.shake ? Math.random()*6 - 3 : 0;
  if(hero.shake > 0) hero.shake--;

  ctx.drawImage(heroImg, hero.x + shakeX, hero.y, hero.w, hero.h);

  if(state === "finish"){
    ctx.font = "bold 56px Arial";
    ctx.textAlign = "center";
    ctx.fillText("FINISH", canvas.width/2, canvas.height/2);
  }

  frame++;
  requestAnimationFrame(loop);
}

loop();
</script>

</body>
</html>
