<!DOCTYPE html>
<html lang="bn">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>মির্জা সাহেব কে বাঁচাও</title>

<style>
body {
  margin: 0;
  overflow: hidden;
  font-family: Arial, sans-serif;
  background: linear-gradient(180deg,#1e3c72,#2a5298);
  color: white;
}

#ui {
  position: fixed;
  top: 10px;
  width: 100%;
  text-align: center;
  z-index: 10;
}

#score {
  margin-top: 6px;
}

canvas {
  display: block;
}

#controls {
  position: fixed;
  bottom: 60px;
  width: 100%;
  display: flex;
  justify-content: center;
  gap: 15px;
  z-index: 10;
}

.btn {
  padding: 12px 22px;
  font-size: 16px;
  border: none;
  border-radius: 8px;
  background: crimson;
  color: white;
}

#footer {
  position: fixed;
  bottom: 8px;
  width: 100%;
  text-align: center;
  font-size: 13px;
  color: #ddd;
}

#footer span {
  color: #00ffd5;
  font-weight: bold;
}
</style>
</head>

<body>

<div id="ui">
  <div><b>মির্জা সাহেব কে বাঁচাও</b></div>
  <div id="score">Score: 0</div>
</div>

<canvas id="game"></canvas>

<div id="controls">
  <button class="btn" onclick="startGame()">START</button>
  <button class="btn" onclick="endGame()">END</button>
</div>

<div id="footer">
  Developed by <span>Mahmud Gaming</span>
</div>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");
canvas.width = innerWidth;
canvas.height = innerHeight;

let ground = canvas.height - 140;
let running = false;
let score = 0;
let speed = 6;
let frame = 0;

const heroImg = new Image();
heroImg.src = "mirza.png";

const villainImg = new Image();
villainImg.src = "nasir.png";

let player = {
  x: 80,
  y: ground,
  w: 60,
  h: 80,
  vy: 0,
  jumping: false,
  low: false
};

let obstacles = [];
const gravity = 1;

function startGame() {
  running = true;
  obstacles = [];
  score = 0;
  speed = 6;
}

function endGame() {
  running = false;
}

function jump() {
  if (!player.jumping && !player.low) {
    player.vy = -18;
    player.jumping = true;
    navigator.vibrate?.(30);
  }
}

function low() {
  if (!player.jumping) {
    player.low = true;
    player.h = 45;
  }
}

function stand() {
  player.low = false;
  player.h = 80;
}

document.addEventListener("click", jump);
document.addEventListener("keydown", e => {
  if (e.code === "Space") jump();
  if (e.code === "ArrowDown") low();
});
document.addEventListener("keyup", e => {
  if (e.code === "ArrowDown") stand();
});

function spawnObstacle() {
  obstacles.push({
    x: canvas.width,
    y: ground + 30,
    w: 50,
    h: 60
  });
}

function update() {
  ctx.clearRect(0,0,canvas.width,canvas.height);

  if (running) {
    // physics
    player.vy += gravity;
    player.y += player.vy;

    if (player.y >= ground) {
      player.y = ground;
      player.vy = 0;
      player.jumping = false;
    }

    if (frame % 90 === 0) spawnObstacle();
    if (frame % 300 === 0) speed += 0.6;

    obstacles.forEach(o => {
      o.x -= speed;

      // collision
      if (
        player.x < o.x + o.w &&
        player.x + player.w > o.x &&
        player.y < o.y + o.h &&
        player.y + player.h > o.y
      ) {
        navigator.vibrate?.([100,50,100]);
        alert("Game Over\nScore: " + score);
        running = false;
      }

      ctx.drawImage(villainImg, o.x, o.y, o.w, o.h);
    });

    obstacles = obstacles.filter(o => o.x + o.w > 0);
    score++;
    document.getElementById("score").innerText = "Score: " + score;
    frame++;
  }

  // hero
  ctx.drawImage(heroImg, player.x, player.y, player.w, player.h);

  requestAnimationFrame(update);
}

update();
</script>

</body>
</html>
