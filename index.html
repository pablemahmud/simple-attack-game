<!DOCTYPE html>
<html lang="bn">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>‡¶Æ‡¶ø‡¶∞‡ßç‡¶ú‡¶æ ‡¶∏‡¶æ‡¶π‡ßá‡¶¨ ‡¶ï‡ßá ‡¶¨‡¶æ‡¶Å‡¶ö‡¶æ‡¶ì</title>

<style>
body{
  margin:0;
  overflow:hidden;
  font-family:Arial,sans-serif;
  background:linear-gradient(180deg,#0f2027,#203a43,#2c5364);
  color:white;
  touch-action:none;
  user-select:none;
}

#ui{
  position:fixed;
  top:10px;
  width:100%;
  z-index:10;
}

#title{text-align:center;font-weight:bold;}

#score{
  position:fixed;
  top:10px;
  right:12px;
}

#life{text-align:center;color:#ff7675;}

canvas{display:block}

#startBtn{
  position:fixed;
  bottom:140px;
  left:50%;
  transform:translateX(-50%);
  padding:14px 30px;
  font-size:18px;
  border:none;
  border-radius:10px;
  background:#ff4757;
  color:white;
  z-index:10;
}

#controls{
  position:fixed;
  bottom:20px;
  left:0;
  width:100%;
  max-width:100vw;
  box-sizing:border-box;
  padding:0 60px 0 20px; /* ‡¶°‡¶æ‡¶® ‡¶¶‡¶ø‡¶ï ‡¶®‡¶ø‡¶∂‡ßç‡¶ö‡¶ø‡¶§‡¶≠‡¶æ‡¶¨‡ßá ‡¶≠‡ßá‡¶§‡¶∞‡ßá */
  display:flex;
  justify-content:space-between;
  z-index:10;
}

.ctrlBtn{
  width:70px;
  height:70px;
  border-radius:50%;
  background:rgba(255,255,255,0.25);
  border:none;
  position:relative;
}

.ctrlBtn:active{
  background:rgba(255,255,255,0.45);
}

.ctrlBtn::before{
  content:"";
  position:absolute;
  top:50%;
  left:50%;
  transform:translate(-50%,-50%);
  border-style:solid;
}

#leftBtn::before{
  border-width:14px 18px 14px 0;
  border-color:transparent white transparent transparent;
}

#rightBtn::before{
  border-width:14px 0 14px 18px;
  border-color:transparent transparent transparent white;
}

/* üî• HARD FIX: RIGHT BUTTON ALWAYS INSIDE */
#rightBtn{
  margin-right:2px;
}
</style>
</head>

<body>

<div id="ui">
  <div id="title">‡¶Æ‡¶ø‡¶∞‡ßç‡¶ú‡¶æ ‡¶∏‡¶æ‡¶π‡ßá‡¶¨ ‡¶ï‡ßá ‡¶¨‡¶æ‡¶Å‡¶ö‡¶æ‡¶ì</div>
  <div id="score">Score: 0</div>
  <div id="life">‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è</div>
</div>

<canvas id="game"></canvas>
<button id="startBtn">START</button>

<div id="controls">
  <div class="ctrlBtn" id="leftBtn"></div>
  <div class="ctrlBtn" id="rightBtn"></div>
</div>

<script>
/* UI */
const life = document.getElementById("life");
const scoreDiv = document.getElementById("score");
const startBtn = document.getElementById("startBtn");

/* CANVAS */
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");
canvas.width = innerWidth;
canvas.height = innerHeight;

/* IMAGES */
const heroImg = new Image();
const heroHitImg = new Image();
const villainImg = new Image();
heroImg.src = "mirza.png";
heroHitImg.src = "hit.png";
villainImg.src = "nasir.png";

/* AUDIO */
const bgMusic = new Audio("game.mp3");
bgMusic.loop = true;
bgMusic.volume = 0.8;
const hitSound = new Audio("hit.mp3");

/* STATE */
let state="idle";
let score=0, frame=0, lives=3;
let shootInterval=120;

/* HERO */
let hero={
  x:canvas.width/2-40,
  y:canvas.height-140,
  w:80,
  h:110,
  speed:6,
  shake:0
};

/* VILLAIN */
let villain={
  x:canvas.width/2-65,
  y:20,
  w:130,
  h:170,
  dir:1,
  speed:3
};

let bullets=[];

/* AUDIO UNLOCK */
function unlockAudio(){
  bgMusic.play().then(()=>{
    bgMusic.pause();
    bgMusic.currentTime=0;
  }).catch(()=>{});
  document.removeEventListener("touchstart",unlockAudio);
  document.removeEventListener("click",unlockAudio);
}
document.addEventListener("touchstart",unlockAudio);
document.addEventListener("click",unlockAudio);

/* START */
startBtn.onclick=()=>{
  state="play";
  score=0; frame=0; lives=3;
  bullets=[];
  shootInterval=120;
  hero.x=canvas.width/2-hero.w/2;
  life.innerText="‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è";
  scoreDiv.innerText="Score: 0";
  bgMusic.currentTime=0;
  bgMusic.play();
  startBtn.style.display="none";
};

/* CONTROLS */
let moveLeft=false, moveRight=false;
function bind(btn,fn){
  btn.addEventListener("touchstart",e=>{e.preventDefault();fn(true);});
  btn.addEventListener("touchend",e=>{e.preventDefault();fn(false);});
  btn.addEventListener("mousedown",()=>fn(true));
  btn.addEventListener("mouseup",()=>fn(false));
}
bind(leftBtn,v=>moveLeft=v);
bind(rightBtn,v=>moveRight=v);

/* SHOOT */
function shoot(){
  bullets.push({
    x:villain.x+villain.w/2,
    y:villain.y+villain.h,
    vy:7
  });
}

/* HIT */
function hit(){
  lives--;
  hero.shake=12;
  hitSound.currentTime=0;
  hitSound.play();
  navigator.vibrate?.([120]);
  life.innerText="‚ù§Ô∏è".repeat(lives);
  if(lives<=0){
    state="finish";
    bgMusic.pause();
    startBtn.style.display="block";
  }
}

/* LOOP */
function loop(){
  ctx.clearRect(0,0,canvas.width,canvas.height);

  if(state==="play"){
    if(moveLeft) hero.x-=hero.speed;
    if(moveRight) hero.x+=hero.speed;

    villain.x+=villain.dir*villain.speed;
    if(villain.x<=0||villain.x+villain.w>=canvas.width) villain.dir*=-1;

    if(frame%shootInterval===0) shoot();

    bullets.forEach(b=>{
      b.y+=b.vy;
      ctx.fillStyle="gold";
      ctx.beginPath();
      ctx.arc(b.x,b.y,6,0,Math.PI*2);
      ctx.fill();
      if(hero.x<b.x&&hero.x+hero.w>b.x&&hero.y<b.y&&hero.y+hero.h>b.y){
        hit();
        b.y=canvas.height+200;
      }
    });

    bullets=bullets.filter(b=>b.y<canvas.height+100);
    score++;
    scoreDiv.innerText="Score: "+score;

    if(frame%200===0) shootInterval=Math.max(15,shootInterval-10);
  }

  ctx.drawImage(villainImg,villain.x,villain.y,villain.w,villain.h);

  hero.x=Math.max(0,Math.min(canvas.width-hero.w,hero.x));
  let shake=hero.shake?Math.random()*8-4:0;
  if(hero.shake>0) hero.shake--;

  if(state==="finish"){
    const bigW=hero.w*2.8;
    const bigH=hero.h*2.8;
    ctx.save();
    ctx.shadowColor="rgba(0,0,0,0.6)";
    ctx.shadowBlur=30;
    ctx.drawImage(
      heroHitImg,
      canvas.width/2-bigW/2,
      canvas.height/2-bigH/2,
      bigW,
      bigH
    );
    ctx.restore();
  }else{
    ctx.drawImage(heroImg,hero.x+shake,hero.y,hero.w,hero.h);
  }

  frame++;
  requestAnimationFrame(loop);
}
loop();
</script>

</body>
</html>
