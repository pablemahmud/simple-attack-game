<!DOCTYPE html>
<html lang="bn">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>মির্জা সাহেব কে বাঁচাও</title>

<style>
body{
  margin:0;
  overflow:hidden;
  font-family:Arial,sans-serif;
  background:linear-gradient(180deg,#0f2027,#203a43,#2c5364);
  color:white;
  touch-action:none;
}
#ui{
  position:fixed;
  top:10px;
  width:100%;
  text-align:center;
  z-index:10;
}
#score{margin-top:4px}
#life{margin-top:4px;color:#ff7675}

canvas{display:block}

/* START */
#startBtn{
  position:fixed;
  bottom:130px;
  left:50%;
  transform:translateX(-50%);
  padding:14px 30px;
  font-size:18px;
  border:none;
  border-radius:10px;
  background:#ff4757;
  color:white;
  z-index:10;
}

/* ARROW CONTROLS */
#controls{
  position:fixed;
  bottom:20px;
  width:100%;
  display:flex;
  justify-content:space-between;
  padding:0 30px;
  z-index:10;
}
.ctrlBtn{
  width:70px;
  height:70px;
  border-radius:50%;
  border:none;
  font-size:32px;
  background:rgba(255,255,255,0.15);
  color:white;
}
.ctrlBtn:active{
  background:rgba(255,255,255,0.35);
}

/* FOOTER */
#footer{
  position:fixed;
  bottom:8px;
  width:100%;
  text-align:center;
  font-size:13px;
}
#footer span{color:#00ffd5;font-weight:bold;}
</style>
</head>

<body>

<div id="ui">
  <b>মির্জা সাহেব কে বাঁচাও</b>
  <div id="score">Score: 0</div>
  <div id="life">❤️❤️❤️</div>
</div>

<canvas id="game"></canvas>

<button id="startBtn" onclick="startGame()">START</button>

<!-- Arrow Buttons -->
<div id="controls">
  <button class="ctrlBtn" id="leftBtn">⬅️</button>
  <button class="ctrlBtn" id="rightBtn">➡️</button>
</div>

<div id="footer">
  Developed by <span>Mahmud Gaming</span>
</div>

<script>
/* ========== SETUP ========== */
const canvas=document.getElementById("game");
const ctx=canvas.getContext("2d");
canvas.width=innerWidth;
canvas.height=innerHeight;

const heroImg=new Image();
heroImg.src="mirza.png";
const villainImg=new Image();
villainImg.src="nasir.png";

/* ========== GAME STATE ========== */
let state="idle";
let score=0,frame=0,difficulty=1;
let lives=3;

/* ========== HERO ========== */
let hero={
  x:canvas.width/2-30,
  y:canvas.height-110,
  w:60,h:80,
  speed:6,
  shake:0
};

/* ========== VILLAIN ========== */
let villain={
  x:canvas.width/2-40,
  y:20,
  w:80,h:100,
  dir:1,speed:3
};

let bullets=[];

/* ========== START ========== */
function startGame(){
  state="play";
  score=0;frame=0;difficulty=1;lives=3;
  bullets=[];
  hero.x=canvas.width/2-hero.w/2;
  document.getElementById("life").innerText="❤️❤️❤️";
  document.getElementById("score").innerText="Score: 0";
  document.getElementById("startBtn").style.display="none";
}

/* ========== KEYBOARD ========== */
document.addEventListener("keydown",e=>{
  if(state!=="play")return;
  if(e.code==="ArrowLeft")hero.x-=hero.speed;
  if(e.code==="ArrowRight")hero.x+=hero.speed;
});

/* ========== TOUCH BUTTON CONTROL ========== */
let moveLeft=false, moveRight=false;

const leftBtn=document.getElementById("leftBtn");
const rightBtn=document.getElementById("rightBtn");

leftBtn.addEventListener("touchstart",()=>moveLeft=true);
leftBtn.addEventListener("touchend",()=>moveLeft=false);
rightBtn.addEventListener("touchstart",()=>moveRight=true);
rightBtn.addEventListener("touchend",()=>moveRight=false);

/* Desktop click support */
leftBtn.addEventListener("mousedown",()=>moveLeft=true);
leftBtn.addEventListener("mouseup",()=>moveLeft=false);
rightBtn.addEventListener("mousedown",()=>moveRight=true);
rightBtn.addEventListener("mouseup",()=>moveRight=false);

/* ========== SHOOT ========== */
function shoot(){
  bullets.push({
    x:villain.x+villain.w/2,
    y:villain.y+villain.h,
    vy:6+difficulty
  });
}

/* ========== HIT ========== */
function hit(){
  lives--;
  hero.shake=10;
  navigator.vibrate?.([80,40,80]);
  document.getElementById("life").innerText="❤️".repeat(lives);
  if(lives<=0){
    state="finish";
    document.getElementById("startBtn").style.display="block";
  }
}

/* ========== LOOP ========== */
function loop(){
  ctx.clearRect(0,0,canvas.width,canvas.height);

  if(state==="play"){
    /* Arrow movement */
    if(moveLeft) hero.x-=hero.speed;
    if(moveRight) hero.x+=hero.speed;

    /* Villain */
    villain.x+=villain.dir*villain.speed*difficulty;
    if(villain.x<=0||villain.x+villain.w>=canvas.width)villain.dir*=-1;

    if(frame%Math.max(40,120-difficulty*10)===0)shoot();

    bullets.forEach(b=>{
      b.y+=b.vy;
      ctx.fillStyle="gold";
      ctx.beginPath();
      ctx.arc(b.x,b.y,6,0,Math.PI*2);
      ctx.fill();

      if(
        hero.x<b.x+6&&hero.x+hero.w>b.x-6&&
        hero.y<b.y+6&&hero.y+hero.h>b.y
      ){
        hit();
        b.y=canvas.height+100;
      }
    });

    bullets=bullets.filter(b=>b.y<canvas.height+50);

    score++;
    if(frame%300===0)difficulty+=0.3;
    document.getElementById("score").innerText="Score: "+score;
  }

  /* Draw villain */
  ctx.drawImage(villainImg,villain.x,villain.y,villain.w,villain.h);

  /* Hero bounds + shake */
  hero.x=Math.max(0,Math.min(canvas.width-hero.w,hero.x));
  let shakeX=hero.shake?Math.random()*6-3:0;
  if(hero.shake>0)hero.shake--;
  ctx.drawImage(heroImg,hero.x+shakeX,hero.y,hero.w,hero.h);

  if(state==="finish"){
    ctx.font="bold 56px Arial";
    ctx.textAlign="center";
    ctx.fillText("FINISH",canvas.width/2,canvas.height/2);
  }

  frame++;
  requestAnimationFrame(loop);
}
loop();
</script>

</body>
</html>
